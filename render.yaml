services: 
  - type: web
    name: hotel10-server
    env: node

    buildCommand: |
      echo "ðŸ“¦ Installing dependencies..."
      npm install

      echo "ðŸ›  Generating Prisma Client..."
      npx prisma generate

      echo "ðŸš€ Pushing Prisma schema to the DB..."
      npx prisma db push --accept-data-loss

      echo "âœ… Prisma DB sync done."

    startCommand: npm run start:prod

    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: hotel10-database
          property: connectionString

    buildFilter:
      paths:
        - "prisma/**"
        - "src/**"
