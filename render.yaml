services:
  - type: web
    name: hotel10-server
    env: node
    buildCommand: npm install
    startCommand: npm run start:prod

    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: hotel10-database
          property: connectionString

    buildFilter:
      paths:
        - "prisma/**"
        - "src/**"

    buildScript:
      command: |
        echo "▶ Generating Prisma Client..."
        npx prisma generate

        echo "▶ Running Prisma Migrations..."
        npx prisma migrate deploy
